{% extends "base.html" %}

{% block title %}Import Domains - SPF/DMARC/DKIM Watcher{% endblock %}

{% block content %}

<h1 class="text-xl font-bold text-light-content-primary dark:text-content-primary mb-4">
  <i class="bi bi-upload mr-2"></i>Import Domains
</h1>

<div class="grid grid-cols-12 gap-6">
  {# ── Upload form ── #}
  <div class="col-span-12 lg:col-span-7">
    <div class="mica-card overflow-hidden">
      <div class="px-4 py-3 border-b border-light-surface-border/20 dark:border-surface-border/10">
        <span class="font-semibold text-sm text-light-content-primary dark:text-content-primary">
          <i class="bi bi-file-earmark-text mr-1.5"></i>Upload File
        </span>
      </div>
      <div class="p-4">
        <form method="post"
              action="{{ url_for('ingest.index') }}"
              enctype="multipart/form-data">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />

          <div class="mb-4">
            <label for="email_file"
                   class="block text-sm font-semibold text-light-content-primary dark:text-content-primary mb-1">
              Domain or email list file
            </label>
            <input
              class="mica-input"
              type="file"
              id="email_file"
              name="email_file"
              accept=".txt,.csv,text/plain"
            />
            <p class="mt-1 text-xs text-light-content-muted dark:text-content-muted">
              Upload a plain-text file containing <strong>domain names</strong>,
              <strong>email addresses</strong>, or a mix of both.
              Domains are extracted automatically. Maximum file size: 1 MB.
            </p>
          </div>

          <button type="submit" class="btn-primary">
            <i class="bi bi-cloud-upload"></i>Import
          </button>
        </form>
      </div>
    </div>
  </div>

  {# ── Help sidebar ── #}
  <div class="col-span-12 lg:col-span-5 space-y-4">
    <div class="mica-card overflow-hidden">
      <div class="px-4 py-3 border-b border-light-surface-border/20 dark:border-surface-border/10">
        <span class="font-semibold text-sm text-light-content-primary dark:text-content-primary">
          <i class="bi bi-question-circle mr-1.5"></i>How It Works
        </span>
      </div>
      <div class="p-4 text-sm text-light-content-muted dark:text-content-muted">
        <ol class="list-decimal pl-5 space-y-1.5">
          <li>
            Upload a plain-text file (.txt or .csv) containing
            <strong class="text-light-content-primary dark:text-content-primary">domain names</strong> or
            <strong class="text-light-content-primary dark:text-content-primary">email addresses</strong>.
          </li>
          <li>
            The importer detects the format automatically:
            <ul class="list-disc pl-5 mt-1 space-y-0.5">
              <li><strong class="text-light-content-primary dark:text-content-primary">Email list</strong> &mdash; domains are extracted from each
                address (e.g. <code class="text-xs bg-gray-100 dark:bg-surface-raised px-1 py-0.5 rounded">user@example.com</code> &rarr;
                <code class="text-xs bg-gray-100 dark:bg-surface-raised px-1 py-0.5 rounded">example.com</code>).</li>
              <li><strong class="text-light-content-primary dark:text-content-primary">Domain list</strong> &mdash; bare domain names are accepted
                directly (e.g. <code class="text-xs bg-gray-100 dark:bg-surface-raised px-1 py-0.5 rounded">example.com</code>).</li>
              <li><strong class="text-light-content-primary dark:text-content-primary">Mixed</strong> &mdash; both formats in the same file.</li>
            </ul>
          </li>
          <li>Duplicate domains are automatically deduplicated.</li>
          <li>Domains already monitored are skipped. Inactive domains are reactivated.</li>
          <li>Each new domain is created with default DKIM selectors.</li>
        </ol>
      </div>
    </div>

    <div class="mica-card overflow-hidden">
      <div class="px-4 py-3 border-b border-light-surface-border/20 dark:border-surface-border/10">
        <span class="font-semibold text-sm text-light-content-primary dark:text-content-primary">
          <i class="bi bi-file-text mr-1.5"></i>Example: Email List
        </span>
      </div>
      <div class="p-4">
        <pre class="text-xs text-light-content-muted dark:text-content-muted font-mono leading-relaxed">alice@example.com
bob@another-domain.org
carol@subdomain.company.net
dave@example.com</pre>
      </div>
    </div>

    <div class="mica-card overflow-hidden">
      <div class="px-4 py-3 border-b border-light-surface-border/20 dark:border-surface-border/10">
        <span class="font-semibold text-sm text-light-content-primary dark:text-content-primary">
          <i class="bi bi-file-text mr-1.5"></i>Example: Domain List
        </span>
      </div>
      <div class="p-4">
        <pre class="text-xs text-light-content-muted dark:text-content-muted font-mono leading-relaxed">example.com
another-domain.org
subdomain.company.net</pre>
      </div>
    </div>
  </div>
</div>

{% endblock %}
